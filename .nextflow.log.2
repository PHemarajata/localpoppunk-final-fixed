Jul-07 17:09:55.340 [main] DEBUG nextflow.cli.Launcher - $> nextflow run poppunk_subsample_snp.nf -profile large_dataset_optimized --input /home/phemarajata/Downloads/bp_bigset/ --resultsDir /home/phemarajata/Downloads/bp_bigset/refined_samples_results --use_all_samples false -resume
Jul-07 17:09:55.414 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 25.04.4
Jul-07 17:09:55.428 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/home/phemarajata/.nextflow/plugins; core-plugins: nf-amazon@2.15.0,nf-azure@1.16.0,nf-cloudcache@0.4.3,nf-codecommit@0.2.3,nf-console@1.2.1,nf-google@1.21.0,nf-k8s@1.0.0,nf-tower@1.11.3,nf-wave@1.12.1
Jul-07 17:09:55.444 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Jul-07 17:09:55.445 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Jul-07 17:09:55.447 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Jul-07 17:09:55.454 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Jul-07 17:09:55.468 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /home/phemarajata/Downloads/localpoppunk-final-fixed/nextflow.config
Jul-07 17:09:55.470 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /home/phemarajata/Downloads/localpoppunk-final-fixed/nextflow.config
Jul-07 17:09:55.490 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /home/phemarajata/.nextflow/secrets/store.json
Jul-07 17:09:55.493 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@c68a5f8] - activable => nextflow.secret.LocalSecretsProvider@c68a5f8
Jul-07 17:09:55.503 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `large_dataset_optimized`
Jul-07 17:09:56.000 [main] DEBUG nextflow.config.ConfigBuilder - Available config profiles: [bus_error_prevention, large_dataset_optimized, ultra_bus_error_prevention, local]
Jul-07 17:09:56.026 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declaration
Jul-07 17:09:56.041 [main] DEBUG nextflow.cli.CmdRun - Launching `poppunk_subsample_snp.nf` [maniac_swanson] DSL2 - revision: 934c633e78
Jul-07 17:09:56.042 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Jul-07 17:09:56.043 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[]
Jul-07 17:09:56.078 [main] DEBUG nextflow.Session - Session UUID: 299d8ad5-c032-41cb-b4f2-1b91156b41fa
Jul-07 17:09:56.079 [main] DEBUG nextflow.Session - Run name: maniac_swanson
Jul-07 17:09:56.079 [main] DEBUG nextflow.Session - Executor pool size: 22
Jul-07 17:09:56.083 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Jul-07 17:09:56.086 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=66; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Jul-07 17:09:56.099 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 25.04.4 build 5950
  Created: 16-06-2025 14:23 UTC (21:23 ICST)
  System: Linux 6.11.0-29-generic
  Runtime: Groovy 4.0.26 on Java HotSpot(TM) 64-Bit Server VM 17.0.12+8-LTS-286
  Encoding: UTF-8 (UTF-8)
  Process: 3908515@phemarajata-Stealth-16-MercedesAMG-A1VGG [127.0.1.1]
  CPUs: 22 - Mem: 62.3 GB (1.2 GB) - Swap: 8 GB (7.3 GB)
Jul-07 17:09:56.119 [main] DEBUG nextflow.Session - Work-dir: /home/phemarajata/Downloads/localpoppunk-final-fixed/work [ext2/ext3]
Jul-07 17:09:56.119 [main] DEBUG nextflow.Session - Script base path does not exist or is not a directory: /home/phemarajata/Downloads/localpoppunk-final-fixed/bin
Jul-07 17:09:56.125 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Jul-07 17:09:56.131 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Jul-07 17:09:56.160 [main] DEBUG nextflow.Session - Observer factory (v2): LinObserverFactory
Jul-07 17:09:56.179 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Jul-07 17:09:56.186 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 23; maxThreads: 1000
Jul-07 17:09:56.226 [main] DEBUG nextflow.Session - Session start
Jul-07 17:09:56.231 [main] DEBUG nextflow.Session - Report file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/execution_report.html -- enable the 'report.overwrite' option in your config file to overwrite existing files
nextflow.exception.AbortOperationException: Report file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/execution_report.html -- enable the 'report.overwrite' option in your config file to overwrite existing files
	at nextflow.trace.ReportObserver.onFlowCreate(ReportObserver.groovy:133)
	at nextflow.Session$_notifyFlowCreate_lambda40.doCall(Session.groovy:1093)
	at nextflow.Session.notifyEvent(Session.groovy:1138)
	at nextflow.Session.notifyFlowCreate(Session.groovy:1093)
	at nextflow.Session.start(Session.groovy:585)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:133)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:379)
	at nextflow.cli.Launcher.run(Launcher.groovy:513)
	at nextflow.cli.Launcher.main(Launcher.groovy:673)
Jul-07 17:09:56.232 [main] DEBUG nextflow.Session - Timeline file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/timeline.html -- enable the 'timeline.overwrite' option in your config file to overwrite existing files
nextflow.exception.AbortOperationException: Timeline file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/timeline.html -- enable the 'timeline.overwrite' option in your config file to overwrite existing files
	at nextflow.trace.TimelineObserver.onFlowCreate(TimelineObserver.groovy:76)
	at nextflow.Session$_notifyFlowCreate_lambda40.doCall(Session.groovy:1093)
	at nextflow.Session.notifyEvent(Session.groovy:1138)
	at nextflow.Session.notifyFlowCreate(Session.groovy:1093)
	at nextflow.Session.start(Session.groovy:585)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:133)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:379)
	at nextflow.cli.Launcher.run(Launcher.groovy:513)
	at nextflow.cli.Launcher.main(Launcher.groovy:673)
Jul-07 17:09:56.233 [main] DEBUG nextflow.Session - DAG file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/pipeline_dag.svg -- enable `dag.overwrite` in your config file to overwrite existing DAG files
nextflow.exception.AbortOperationException: DAG file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/pipeline_dag.svg -- enable `dag.overwrite` in your config file to overwrite existing DAG files
	at org.codehaus.groovy.vmplugin.v8.IndyInterface.fromCache(IndyInterface.java:321)
	at nextflow.trace.GraphObserver.onFlowCreate(GraphObserver.groovy:77)
	at nextflow.Session$_notifyFlowCreate_lambda40.doCall(Session.groovy:1093)
	at nextflow.Session.notifyEvent(Session.groovy:1138)
	at nextflow.Session.notifyFlowCreate(Session.groovy:1093)
	at nextflow.Session.start(Session.groovy:585)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:133)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:379)
	at nextflow.cli.Launcher.run(Launcher.groovy:513)
	at nextflow.cli.Launcher.main(Launcher.groovy:673)
Jul-07 17:09:56.812 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Jul-07 17:09:56.817 [main] INFO  nextflow.script.BaseScript - ‚ñ∂ FASTA input directory:  /home/phemarajata/Downloads/bp_bigset/
Jul-07 17:09:56.818 [main] INFO  nextflow.script.BaseScript - ‚ñ∂ Results directory:      /home/phemarajata/Downloads/bp_bigset/refined_samples_results
Jul-07 17:09:56.818 [main] INFO  nextflow.script.BaseScript - ‚ñ∂ Threads / RAM:          16  /  200 GB
Jul-07 17:09:56.964 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:56.964 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:56.968 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Jul-07 17:09:56.972 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=22; memory=62.3 GB; capacity=22; pollInterval=100ms; dumpInterval=5m
Jul-07 17:09:56.973 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Jul-07 17:09:56.988 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'VALIDATE_FASTA': maxForks=0; fair=false; array=0
Jul-07 17:09:57.039 [main] INFO  nextflow.script.BaseScript - üîÑ Using SUBSAMPLING mode - performing MASH-based intelligent subsampling
Jul-07 17:09:57.042 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_SKETCH` matches process MASH_SKETCH
Jul-07 17:09:57.044 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.044 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.045 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'MASH_SKETCH': maxForks=0; fair=false; array=0
Jul-07 17:09:57.048 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_DIST` matches process MASH_DIST
Jul-07 17:09:57.049 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.049 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.050 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'MASH_DIST': maxForks=0; fair=false; array=0
Jul-07 17:09:57.054 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.054 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.055 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'BIN_SUBSAMPLE_OR_ALL': maxForks=0; fair=false; array=0
Jul-07 17:09:57.059 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_MODEL` matches process POPPUNK_MODEL
Jul-07 17:09:57.061 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.061 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.062 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'POPPUNK_MODEL': maxForks=0; fair=false; array=0
Jul-07 17:09:57.068 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_REFINE` matches process POPPUNK_REFINE
Jul-07 17:09:57.069 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.070 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.070 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'POPPUNK_REFINE': maxForks=0; fair=false; array=0
Jul-07 17:09:57.074 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:FILTER_ASSIGNMENT_SAMPLES` matches process FILTER_ASSIGNMENT_SAMPLES
Jul-07 17:09:57.075 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.075 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.076 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'FILTER_ASSIGNMENT_SAMPLES': maxForks=0; fair=false; array=0
Jul-07 17:09:57.080 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:CHUNK_SAMPLES` matches process CHUNK_SAMPLES
Jul-07 17:09:57.081 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.081 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.083 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'CHUNK_SAMPLES': maxForks=0; fair=false; array=0
Jul-07 17:09:57.098 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_ASSIGN_CHUNK` matches process POPPUNK_ASSIGN_CHUNK
Jul-07 17:09:57.099 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.099 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.101 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'POPPUNK_ASSIGN_CHUNK': maxForks=3; fair=false; array=0
Jul-07 17:09:57.108 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MERGE_CHUNK_RESULTS` matches process MERGE_CHUNK_RESULTS
Jul-07 17:09:57.109 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.110 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.110 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'MERGE_CHUNK_RESULTS': maxForks=0; fair=false; array=0
Jul-07 17:09:57.116 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.116 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.117 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SUMMARY_REPORT': maxForks=0; fair=false; array=0
Jul-07 17:09:57.121 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-07 17:09:57.122 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-07 17:09:57.122 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'COPY_FINAL_RESULTS': maxForks=0; fair=false; array=0
Jul-07 17:09:57.127 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: BIN_SUBSAMPLE_OR_ALL, POPPUNK_REFINE, FILTER_ASSIGNMENT_SAMPLES, MASH_DIST, MASH_SKETCH, SUMMARY_REPORT, POPPUNK_MODEL, CHUNK_SAMPLES, MERGE_CHUNK_RESULTS, POPPUNK_ASSIGN_CHUNK, VALIDATE_FASTA, COPY_FINAL_RESULTS
Jul-07 17:09:57.130 [main] DEBUG nextflow.Session - Igniting dataflow network (13)
Jul-07 17:09:57.135 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > VALIDATE_FASTA
Jul-07 17:09:57.135 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > MASH_SKETCH
Jul-07 17:09:57.135 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > MASH_DIST
Jul-07 17:09:57.135 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > BIN_SUBSAMPLE_OR_ALL
Jul-07 17:09:57.136 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > POPPUNK_MODEL
Jul-07 17:09:57.136 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > POPPUNK_REFINE
Jul-07 17:09:57.136 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > FILTER_ASSIGNMENT_SAMPLES
Jul-07 17:09:57.136 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > CHUNK_SAMPLES
Jul-07 17:09:57.137 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > POPPUNK_ASSIGN_CHUNK
Jul-07 17:09:57.137 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > MERGE_CHUNK_RESULTS
Jul-07 17:09:57.137 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SUMMARY_REPORT
Jul-07 17:09:57.137 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > COPY_FINAL_RESULTS
Jul-07 17:09:57.137 [PathVisitor-1] DEBUG nextflow.file.PathVisitor - files for syntax: glob; folder: /home/phemarajata/Downloads/bp_bigset/; pattern: *.fasta; options: [checkIfExists:true]
Jul-07 17:09:57.138 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_2e559d96562f89dc: /home/phemarajata/Downloads/localpoppunk-final-fixed/poppunk_subsample_snp.nf
Jul-07 17:09:57.138 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Jul-07 17:09:57.138 [main] DEBUG nextflow.Session - Session await
Jul-07 17:09:57.314 [Actor Thread 23] INFO  nextflow.processor.TaskProcessor - [b3/4b1fdd] Cached process > VALIDATE_FASTA (validate_fasta)
Jul-07 17:09:57.328 [Actor Thread 11] INFO  nextflow.script.BaseScript - 
==================================================
Jul-07 17:09:57.328 [Actor Thread 11] INFO  nextflow.script.BaseScript - üìã FASTA VALIDATION REPORT
Jul-07 17:09:57.328 [Actor Thread 11] INFO  nextflow.script.BaseScript - ==================================================
Jul-07 17:09:57.329 [Actor Thread 11] INFO  nextflow.script.BaseScript - FASTA Validation Report
======================
Total files processed: 451
Valid files: 451
Invalid files: 0

Valid files (with absolute paths):
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0013.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008781.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0001.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0154.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013365.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012369.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562235_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0044.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0171.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000774405_1_Australia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0005.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561565_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0016.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012327.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014713065_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0021.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0131.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963570575_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012303.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963560735_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0026.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0024.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0006.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001212405_2_Malaysia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963573135_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0150.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0109.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0089.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0001.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569325_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561835_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565015_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963570085_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008798.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0169.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_002110925_1_USA_Texas.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0100.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963567325_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963560675_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963564975_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008828.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0014.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008825.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008835.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_009830075_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_900598305_2.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0201.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0120.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0018.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565085_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571365_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0009.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001212705_2_Malaysia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0110.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000259795_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0002.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001980775_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0202.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963573225_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008820.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0096.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0163.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0102.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0112.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566475_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_002110985_1_USA_Puerto_Rico.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561925_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0012.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963568705_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561975_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566085_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0087.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_025847905_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712875_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0003.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563475_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_025847415_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0055.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0008.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0167.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0182.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963568885_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0094.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0015.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712955_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012330.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0051.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561915_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0057.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566495_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0107.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0022.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0121.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0004.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013360.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0084.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0162.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569365_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_900597175_2.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712945_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0075.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0187.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0103.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561355_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0029.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566765_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0134.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012358.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562795_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566455_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008790.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0054.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0022.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0137.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0111.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0097.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0013.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/SRR12527871_contigs.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000182195_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0156.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0081.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0108.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0141.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0004.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008841.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0014.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0173.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0031.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569705_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008819.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0181.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712775_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008785.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012370.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0007.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0043.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963560945_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569645_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963572615_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0067.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0069.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0183.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0125.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963568055_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561735_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013345.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014713015_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963572995_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963564375_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000410895_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963572755_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963573025_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0185.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0099.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_025848135_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0117.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0148.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0025.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963560915_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0026.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001207785_2_Malaysia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000773235_1_Australia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008833.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_025847635_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001326935_2_Malaysia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565125_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_009827035_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566635_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008830.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008821.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0159.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0079.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963564305_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0068.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0189.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0132.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012365.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0190.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0136.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0101.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0050.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0006.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008794.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0142.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008836.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712915_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571975_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0160.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963570025_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008816.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0149.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012363.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012340.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561435_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0093.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566675_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563155_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013343.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008813.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0178.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563715_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0193.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0144.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0152.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014713055_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0062.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0019.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0151.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000774495_1_Australia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/SRR12527885_contigs.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712935_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_009826725_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0122.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0147.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008829.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0028.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012313.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013348.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0064.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013342.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0155.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0073.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012308.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0200.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0164.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0177.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0165.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0157.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0063.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0060.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963564325_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012317.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008803.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012328.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571055_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_900595585_2.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565675_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0129.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0023.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0199.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_002111105_1_USA_California.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0046.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012320.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571495_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0033.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008817.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008837.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565345_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001980755_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_900596305_2.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012380.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008822.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0041.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0098.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0127.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562695_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_025848015_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0104.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0080.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963573175_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0091.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0034.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0071.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0018.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0011.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012356.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0065.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_003268105_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0070.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0011.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0047.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008792.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0139.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571845_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0030.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569685_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712825_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0076.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0170.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0158.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012331.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0113.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0010.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0036.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0197.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0059.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0017.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963567935_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0056.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012324.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013358.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0016.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000774965_1_Australia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0037.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0143.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013346.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0017.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566855_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012354.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0153.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0133.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0175.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0035.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0015.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0012.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013363.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0074.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0191.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0105.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0040.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963560585_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0184.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0161.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0007.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012309.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0083.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0172.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0058.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0196.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562655_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0024.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963568785_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561215_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0003.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0020.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561245_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963567115_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561855_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0146.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571005_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0128.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0124.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712815_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563525_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001980725_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0176.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0115.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0053.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0042.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0048.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012347.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0090.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013352.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0092.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0027.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0119.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013354.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012314.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_009830095_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0021.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014713085_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0095.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712835_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013364.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000259815_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563305_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565565_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712965_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_002111145_1_USA_Arizona_ex_Costa_Rica.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571475_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963573095_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0019.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014712895_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001980815_1_Thailand.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566175_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0123.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_000756905_1_Australia_Townsville_Queensland.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563635_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0114.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013353.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571745_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0166.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012316.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IE-0010.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0072.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0145.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012351.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_001326955_2_Malaysia.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963570975_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0180.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0138.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569795_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0118.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012376.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012338.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0066.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0045.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_003268075_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562615_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0179.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_003268115_1_Viet_Nam.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0195.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0086.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS013355.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012362.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008838.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0038.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0061.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012307.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562965_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0039.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0052.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008784.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0186.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCF_014713025_1_Laos.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008809.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0106.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963564785_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963571905_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0049.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0085.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963570105_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008786.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008844.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561075_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0168.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0088.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561765_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0126.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565485_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012306.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963562325_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0005.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963565395_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008824.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0032.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0116.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566625_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963566695_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0192.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0078.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012312.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0082.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0135.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008804.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0140.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0009.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0188.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963569785_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963563065_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012332.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008797.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS008795.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963561895_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012359.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012334.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0077.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/GCA_963568005_1.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0174.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/ERS012377.fasta
  ‚úì /home/phemarajata/Downloads/bp_bigset/IP-0130.fasta


Jul-07 17:09:57.330 [Actor Thread 11] INFO  nextflow.script.BaseScript - ==================================================

Jul-07 17:09:57.340 [Actor Thread 23] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'PublishDir' minSize=10; maxSize=66; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Jul-07 17:09:57.405 [Actor Thread 19] INFO  nextflow.processor.TaskProcessor - [93/bfd1e0] Cached process > MASH_SKETCH (mash_sketch)
Jul-07 17:09:57.412 [Actor Thread 19] INFO  nextflow.processor.TaskProcessor - [74/dbfd9b] Cached process > MASH_DIST (mash_dist)
Jul-07 17:09:57.432 [Actor Thread 22] INFO  nextflow.processor.TaskProcessor - [bc/d74415] Cached process > BIN_SUBSAMPLE_OR_ALL (bin_subsample_or_all)
Jul-07 17:09:57.455 [Actor Thread 22] INFO  nextflow.processor.TaskProcessor - [fb/c98ea8] Cached process > POPPUNK_MODEL (poppunk_model)
Jul-07 17:09:57.470 [Actor Thread 23] INFO  nextflow.processor.TaskProcessor - [3a/ad2cbb] Cached process > FILTER_ASSIGNMENT_SAMPLES (filter_assignment_samples)
Jul-07 17:09:57.475 [Actor Thread 13] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=POPPUNK_REFINE (poppunk_refine); work-dir=null
  error [nextflow.exception.ProcessUnrecoverableException]: Process `POPPUNK_REFINE (poppunk_refine)` script contains error(s)
Jul-07 17:09:57.482 [Actor Thread 23] INFO  nextflow.processor.TaskProcessor - [86/09df60] Cached process > CHUNK_SAMPLES (chunk_samples)
Jul-07 17:09:57.490 [Actor Thread 13] ERROR nextflow.processor.TaskProcessor - Error executing process > 'POPPUNK_REFINE (poppunk_refine)'

Caused by:
  No such variable: critical_files_missing -- Check script 'poppunk_subsample_snp.nf' at line: 549


Source block:
      """
      echo "üî¨ Starting PopPUNK model refinement for B. pseudomallei..."
      echo "Refinement is crucial for B. pseudomallei due to high recombination rates"
      
      # Check if the database has a fitted model
      if [ ! -f "${db_dir}/poppunk_db_fit.pkl" ] && [ ! -f "${db_dir}/poppunk_fit_fit.pkl" ]; then
          echo "‚ùå No fitted model found in database directory"
          echo "Available files in database:"
          ls -la ${db_dir}/
          exit 1
      fi
      
      # Copy the original database to avoid modifying it
      echo "üìÅ Copying database for refinement..."
      cp -r ${db_dir} poppunk_db_refined
      
      # Determine which model type was used for appropriate refinement strategy
      model_type="unknown"
      if [ -f "poppunk_db_refined/poppunk_fit_fit.pkl" ] || [ -f "poppunk_db_refined/poppunk_db_fit.pkl" ]; then
          # Check if it's BGMM or DBSCAN by looking for specific files
          if ls poppunk_db_refined/*bgmm* 1> /dev/null 2>&1; then
              model_type="bgmm"
          elif ls poppunk_db_refined/*dbscan* 1> /dev/null 2>&1; then
              model_type="dbscan"
          else
              # Default assumption based on successful model fitting
              model_type="bgmm"
          fi
      fi
      
      echo "üìä Detected model type: \$model_type"
      
      # Calculate conservative thread count for refinement
      refine_threads=\$(echo "${task.cpus}" | awk '{print (\$1 > 6) ? 6 : \$1}')
      echo "Using \$refine_threads threads for model refinement"
      
      # Attempt refinement with progressive fallback strategy
      refinement_success=false
      
      # Attempt 1: Standard refinement with detected model parameters
      echo "üîÑ Attempt 1: Standard model refinement..."
      if [ "${params.poppunk_enable_refinement}" = "true" ]; then
          # Determine refinement type based on parameters
          refine_type=""
          if [ "${params.poppunk_refine_both}" = "true" ]; then
              refine_type="--indiv-refine both"
          elif [ "${params.poppunk_refine_core_only}" = "true" ]; then
              refine_type="--indiv-refine core"
          elif [ "${params.poppunk_refine_accessory_only}" = "true" ]; then
              refine_type="--indiv-refine accessory"
          else
              refine_type="--indiv-refine both"  # Default to both if none specified
          fi
          
          echo "Using refinement type: \$refine_type"
          
          if poppunk --fit-model refine \\
              --ref-db poppunk_db_refined \\
              --output poppunk_refined_attempt1 \\
              --threads \$refine_threads \\
              \$refine_type; then
              
              echo "‚úÖ Model refinement completed successfully"
              refinement_success=true
              
              # Copy refined results back to database
              if [ -d "poppunk_refined_attempt1" ]; then
                  cp poppunk_refined_attempt1/* poppunk_db_refined/ 2>/dev/null || echo "Some refinement files could not be copied"
                  echo "üìÅ Refined model files copied to database"
              fi
              
          else
              echo "‚ö†Ô∏è  Standard refinement failed, trying conservative approach..."
          fi
      else
          echo "‚ÑπÔ∏è  Model refinement disabled in configuration"
          refinement_success=true  # Skip refinement but don't fail
      fi
      
      # Attempt 2: Conservative refinement (if standard failed)
      if [ "\$refinement_success" = false ]; then
          echo "üîÑ Attempt 2: Conservative refinement (single-threaded)..."
          if poppunk --fit-model refine \\
              --ref-db poppunk_db_refined \\
              --output poppunk_refined_attempt2 \\
              --threads 1; then
              
              echo "‚úÖ Conservative model refinement completed"
              refinement_success=true
              
              # Copy refined results back to database
              if [ -d "poppunk_refined_attempt2" ]; then
                  cp poppunk_refined_attempt2/* poppunk_db_refined/ 2>/dev/null || echo "Some refinement files could not be copied"
                  echo "üìÅ Conservative refined model files copied to database"
              fi
              
          else
              echo "‚ö†Ô∏è  Conservative refinement failed, trying minimal approach..."
          fi
      fi
      
      # Attempt 3: Skip refinement but ensure database integrity (fallback)
      if [ "\$refinement_success" = false ]; then
          echo "üîÑ Attempt 3: Skipping refinement due to failures, ensuring database integrity..."
          echo "‚ö†Ô∏è  Model refinement could not be completed, but original model is preserved"
          echo "This may result in less accurate clustering for highly recombinant B. pseudomallei"
          refinement_success=true  # Don't fail the pipeline
      fi
      
      # Generate refinement report
      echo "üìã Generating refinement report..."
      cat > refinement_report.txt << EOF
  PopPUNK Model Refinement Report
  ==============================
  
  Dataset: B. pseudomallei (high recombination species)
  Refinement Status: \$([ "\$refinement_success" = true ] && echo "Completed" || echo "Failed")
  Model Type Detected: \$model_type
  Threads Used: \$refine_threads
  
  Refinement Process:
  - Attempt 1 (Standard): \$([ -d "poppunk_refined_attempt1" ] && echo "Success" || echo "Failed/Skipped")
  - Attempt 2 (Conservative): \$([ -d "poppunk_refined_attempt2" ] && echo "Success" || echo "Failed/Skipped")
  - Attempt 3 (Fallback): \$([ "\$refinement_success" = true ] && echo "Completed" || echo "Failed")
  
  Files in Refined Database:
  \$(ls -la poppunk_db_refined/ | head -20)
  
  Refinement Benefits for B. pseudomallei:
  - Accounts for recombination events in clustering
  - Improves cluster boundary accuracy
  - Better separation of true lineages vs. recombinant variants
  - More biologically meaningful cluster assignments
  
  Note: If refinement failed, the original fitted model is still functional
  but may not optimally handle B. pseudomallei's recombination patterns.
  EOF
      
      # Verify refined database integrity and copy missing critical files
      echo "üîç Verifying refined database integrity..."
      
      # Check and copy fitted model files
      if [ -f "poppunk_db_refined/poppunk_db_fit.pkl" ] || [ -f "poppunk_db_refined/poppunk_fit_fit.pkl" ]; then
          echo "‚úÖ Refined database contains fitted model"
      else
          echo "‚ö†Ô∏è  Refined database missing fitted model, copying from original..."
          cp ${db_dir}/*fit*.pkl poppunk_db_refined/ 2>/dev/null || echo "Could not copy fitted model"
          cp ${db_dir}/*fit*.npz poppunk_db_refined/ 2>/dev/null || echo "Could not copy fitted model data"
      fi
      
      # Check and copy graph files
      if [ -f "poppunk_db_refined/poppunk_db_graph.gt" ] || [ -f "poppunk_db_refined/poppunk_fit_graph.gt" ]; then
          echo "‚úÖ Refined database contains graph file"
      else
          echo "‚ö†Ô∏è  Refined database missing graph file, copying from original..."
          cp ${db_dir}/*graph*.gt poppunk_db_refined/ 2>/dev/null || echo "Could not copy graph file"
      fi
      
      # CRITICAL: Check and copy .h5 database file (contains sketch data)
      if [ -f "poppunk_db_refined/poppunk_db_refined.h5" ] || [ -f "poppunk_db_refined/poppunk_db.h5" ]; then
          echo "‚úÖ Refined database contains .h5 sketch file"
      else
          echo "‚ö†Ô∏è  Refined database missing .h5 file, copying from original..."
          # Copy the original .h5 file with the correct name for the refined database
          if [ -f "${db_dir}/poppunk_db.h5" ]; then
              cp "${db_dir}/poppunk_db.h5" "poppunk_db_refined/poppunk_db_refined.h5"
              echo "‚úì Copied poppunk_db.h5 to poppunk_db_refined.h5"
          else
              echo "‚ùå Original .h5 file not found in ${db_dir}/"
              ls -la ${db_dir}/*.h5 2>/dev/null || echo "No .h5 files found"
          fi
      fi
      
      # Copy any other essential database files
      echo "üìÅ Copying additional database files..."
      cp ${db_dir}/*.dists 2>/dev/null || echo "No .dists files to copy"
      cp ${db_dir}/*.refs 2>/dev/null || echo "No .refs files to copy"
      cp ${db_dir}/*.csv 2>/dev/null || echo "No additional .csv files to copy"
      
      # Ensure proper file naming for refined database
      echo "üîß Ensuring proper file naming for refined database..."
      
      # Rename files to match refined database naming convention
      if [ -f "poppunk_db_refined/poppunk_db_fit.pkl" ] && [ ! -f "poppunk_db_refined/poppunk_db_refined_fit.pkl" ]; then
          cp "poppunk_db_refined/poppunk_db_fit.pkl" "poppunk_db_refined/poppunk_db_refined_fit.pkl"
          echo "‚úì Created poppunk_db_refined_fit.pkl"
      fi
      
      if [ -f "poppunk_db_refined/poppunk_db_graph.gt" ] && [ ! -f "poppunk_db_refined/poppunk_db_refined_graph.gt" ]; then
          cp "poppunk_db_refined/poppunk_db_graph.gt" "poppunk_db_refined/poppunk_db_refined_graph.gt"
          echo "‚úì Created poppunk_db_refined_graph.gt"
      fi
      
      # Final verification - list all files in refined database
      echo "üìã Final refined database contents:"
      ls -la poppunk_db_refined/
      
      # Verify critical files exist
      critical_files_missing=0
      
      if [ ! -f "poppunk_db_refined/poppunk_db_refined.h5" ]; then
          echo "‚ùå Missing critical file: poppunk_db_refined.h5"
          critical_files_missing=\$((critical_files_missing + 1))
      else
          echo "‚úÖ Found critical file: poppunk_db_refined.h5"
      fi
      
      if [ ! -f "poppunk_db_refined/poppunk_db_fit.pkl" ] && [ ! -f "poppunk_db_refined/poppunk_fit_fit.pkl" ]; then
          echo "‚ùå Missing critical file: fitted model (.pkl)"
          critical_files_missing=\$((critical_files_missing + 1))
      else
          echo "‚úÖ Found critical file: fitted model (.pkl)"
      fi
      
      if [ ! -f "poppunk_db_refined/poppunk_db_graph.gt" ] && [ ! -f "poppunk_db_refined/poppunk_fit_graph.gt" ]; then
          echo "‚ùå Missing critical file: graph file (.gt)"
          critical_files_missing=\$((critical_files_missing + 1))
      else
          echo "‚úÖ Found critical file: graph file (.gt)"
      fi
      
      if [ $critical_files_missing -gt 0 ]; then
          echo "‚ö†Ô∏è  Warning: $critical_files_missing critical files missing from refined database"
          echo "Assignment may fail - consider using original database"
      else
          echo "‚úÖ All critical files present in refined database"
      fi
      
      echo "üéâ PopPUNK model refinement process completed!"
      echo "Refined database ready for assignment with improved recombination handling"
      """

Container:
  staphb/poppunk:2.7.5

Tip: when you have fixed the problem you can continue the execution adding the option `-resume` to the run command line
Jul-07 17:09:57.491 [Actor Thread 13] DEBUG nextflow.Session - Session aborted -- Cause: Process `POPPUNK_REFINE (poppunk_refine)` script contains error(s)
Jul-07 17:09:57.505 [Actor Thread 13] DEBUG nextflow.Session - The following nodes are still active:
[process] POPPUNK_REFINE
  status=ACTIVE
  port 0: (value) bound ; channel: db_dir
  port 1: (value) bound ; channel: staged_list
  port 2: (cntrl) -     ; channel: $

[process] POPPUNK_ASSIGN_CHUNK
  status=ACTIVE
  port 0: (queue) OPEN  ; channel: -
  port 1: (value) OPEN  ; channel: db_dir
  port 2: (value) bound ; channel: fasta_files
  port 3: (cntrl) -     ; channel: $

[process] MERGE_CHUNK_RESULTS
  status=ACTIVE
  port 0: (value) OPEN  ; channel: chunk_results
  port 1: (cntrl) -     ; channel: $

[process] SUMMARY_REPORT
  status=ACTIVE
  port 0: (value) OPEN  ; channel: cluster_csv
  port 1: (value) bound ; channel: validation_report
  port 2: (cntrl) -     ; channel: $

[process] COPY_FINAL_RESULTS
  status=ACTIVE
  port 0: (value) OPEN  ; channel: final_csv
  port 1: (value) OPEN  ; channel: summary_report
  port 2: (cntrl) -     ; channel: $

Jul-07 17:09:57.512 [main] DEBUG nextflow.Session - Session await > all processes finished
Jul-07 17:09:57.513 [main] DEBUG nextflow.Session - Session await > all barriers passed
Jul-07 17:09:57.513 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Jul-07 17:09:57.514 [Actor Thread 12] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=POPPUNK_REFINE; work-dir=null
  error [java.lang.InterruptedException]: java.lang.InterruptedException
Jul-07 17:09:57.520 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=0; failedCount=0; ignoredCount=0; cachedCount=7; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=0; succeedDuration=0ms; failedDuration=0ms; cachedDuration=13m 57s;loadCpus=0; loadMemory=0; peakRunning=0; peakCpus=0; peakMemory=0; ]
Jul-07 17:09:57.521 [main] DEBUG nextflow.trace.ReportObserver - Workflow completed -- rendering execution report
Jul-07 17:09:57.828 [main] WARN  nextflow.trace.ReportObserver - Failed to render execution report -- see the log file for details
nextflow.exception.AbortOperationException: Report file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/execution_report.html -- enable the 'report.overwrite' option in your config file to overwrite existing files
	at nextflow.trace.TraceHelper.newFileWriter(TraceHelper.groovy:67)
	at nextflow.trace.ReportObserver.renderHtml(ReportObserver.groovy:284)
	at nextflow.trace.ReportObserver.onFlowComplete(ReportObserver.groovy:143)
	at nextflow.Session$_notifyFlowComplete_lambda45.doCall(Session.groovy:1107)
	at nextflow.Session.notifyEvent(Session.groovy:1138)
	at nextflow.Session.notifyFlowComplete(Session.groovy:1107)
	at nextflow.Session.shutdown0(Session.groovy:768)
	at nextflow.Session.destroy(Session.groovy:713)
	at nextflow.script.ScriptRunner.shutdown(ScriptRunner.groovy:263)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:147)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:379)
	at nextflow.cli.Launcher.run(Launcher.groovy:513)
	at nextflow.cli.Launcher.main(Launcher.groovy:673)
Caused by: java.nio.file.FileAlreadyExistsException: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/execution_report.html
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:94)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:484)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:228)
	at java.base/java.nio.file.Files.newBufferedWriter(Files.java:3008)
	at nextflow.trace.TraceHelper.newFileWriter(TraceHelper.groovy:64)
	... 12 common frames omitted
Jul-07 17:09:57.829 [main] DEBUG nextflow.trace.TimelineObserver - Workflow completed -- rendering execution timeline
Jul-07 17:09:57.859 [main] WARN  nextflow.trace.TimelineObserver - Failed to render execution timeline -- see the log file for details
nextflow.exception.AbortOperationException: Timeline file already exists: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/timeline.html -- enable the 'timeline.overwrite' option in your config file to overwrite existing files
	at nextflow.trace.TraceHelper.newFileWriter(TraceHelper.groovy:67)
	at nextflow.trace.TimelineObserver.renderHtml(TimelineObserver.groovy:178)
	at nextflow.trace.TimelineObserver.onFlowComplete(TimelineObserver.groovy:87)
	at nextflow.Session$_notifyFlowComplete_lambda45.doCall(Session.groovy:1107)
	at nextflow.Session.notifyEvent(Session.groovy:1138)
	at nextflow.Session.notifyFlowComplete(Session.groovy:1107)
	at nextflow.Session.shutdown0(Session.groovy:768)
	at nextflow.Session.destroy(Session.groovy:713)
	at nextflow.script.ScriptRunner.shutdown(ScriptRunner.groovy:263)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:147)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:379)
	at nextflow.cli.Launcher.run(Launcher.groovy:513)
	at nextflow.cli.Launcher.main(Launcher.groovy:673)
Caused by: java.nio.file.FileAlreadyExistsException: /home/phemarajata/Downloads/bp_bigset/refined_samples_results/reports/timeline.html
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:94)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:218)
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:484)
	at java.base/java.nio.file.Files.newOutputStream(Files.java:228)
	at java.base/java.nio.file.Files.newBufferedWriter(Files.java:3008)
	at nextflow.trace.TraceHelper.newFileWriter(TraceHelper.groovy:64)
	... 12 common frames omitted
Jul-07 17:09:57.897 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Jul-07 17:09:57.905 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
